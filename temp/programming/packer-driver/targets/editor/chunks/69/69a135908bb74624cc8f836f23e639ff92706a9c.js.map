{"version":3,"sources":["file:///G:/Cocos/KillGrass/gecao/assets/scripts/HealthManager.ts"],"names":["_decorator","Component","Prefab","instantiate","find","PlayerHealth","ccclass","property","HealthManager","type","tooltip","onLoad","initializeHealthBars","healthPrefab","console","error","canvas","i","soldierName","soldier","node","getChildByName","healthBar","addChild","healthComp","getComponent","init"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAqBC,MAAAA,I,OAAAA,I;;AAC1DC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;+BAGjBQ,a,WADZF,OAAO,CAAC,eAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEP,MAAR;AAAgBQ,QAAAA,OAAO,EAAE;AAAzB,OAAD,C,2BAFb,MACaF,aADb,SACmCP,SADnC,CAC6C;AAAA;AAAA;;AAAA;AAAA;;AAIzCU,QAAAA,MAAM,GAAG;AACL,eAAKC,oBAAL;AACH;;AAEOA,QAAAA,oBAAoB,GAAG;AAC3B,cAAI,CAAC,KAAKC,YAAV,EAAwB;AACpBC,YAAAA,OAAO,CAACC,KAAR,CAAc,2BAAd;AACA;AACH,WAJ0B,CAM3B;;;AACA,gBAAMC,MAAM,GAAGZ,IAAI,CAAC,YAAD,CAAnB;;AACA,cAAI,CAACY,MAAL,EAAa;AACTF,YAAAA,OAAO,CAACC,KAAR,CAAc,8BAAd;AACA;AACH,WAX0B,CAa3B;;;AACA,eAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,CAArB,EAAwBA,CAAC,EAAzB,EAA6B;AACzB,kBAAMC,WAAW,GAAGD,CAAC,GAAG,EAAJ,GAAU,KAAIA,CAAE,EAAhB,GAAqB,IAAGA,CAAE,EAA9C;AACA,kBAAME,OAAO,GAAG,KAAKC,IAAL,CAAUC,cAAV,CAAyBH,WAAzB,CAAhB;;AAEA,gBAAIC,OAAJ,EAAa;AACT;AACA,oBAAMG,SAAS,GAAGnB,WAAW,CAAC,KAAKU,YAAN,CAA7B;AACAG,cAAAA,MAAM,CAACO,QAAP,CAAgBD,SAAhB,EAHS,CAKT;;AACA,oBAAME,UAAU,GAAGF,SAAS,CAACG,YAAV;AAAA;AAAA,+CAAnB;;AACA,kBAAID,UAAJ,EAAgB;AACZA,gBAAAA,UAAU,CAACE,IAAX,CAAgBP,OAAhB;AACH;AACJ;AACJ;AACJ;;AAtCwC,O;;;;;iBAEJ,I","sourcesContent":["import { _decorator, Component, Node, Prefab, instantiate, Canvas, find } from 'cc';\r\nimport { PlayerHealth } from './PlayerHealth';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('HealthManager')\r\nexport class HealthManager extends Component {\r\n    @property({ type: Prefab, tooltip: '血条预制体' })\r\n    public healthPrefab: Prefab | null = null;\r\n\r\n    onLoad() {\r\n        this.initializeHealthBars();\r\n    }\r\n\r\n    private initializeHealthBars() {\r\n        if (!this.healthPrefab) {\r\n            console.error('Health prefab is not set!');\r\n            return;\r\n        }\r\n\r\n        // 获取 Canvas 节点\r\n        const canvas = find('GameCanvas');\r\n        if (!canvas) {\r\n            console.error('Cannot find GameCanvas node!');\r\n            return;\r\n        }\r\n\r\n        // 遍历所有士兵节点（001-008）\r\n        for (let i = 1; i <= 8; i++) {\r\n            const soldierName = i < 10 ? `00${i}` : `0${i}`;\r\n            const soldier = this.node.getChildByName(soldierName);\r\n            \r\n            if (soldier) {\r\n                // 创建血条实例\r\n                const healthBar = instantiate(this.healthPrefab);\r\n                canvas.addChild(healthBar);\r\n                \r\n                // 初始化血条\r\n                const healthComp = healthBar.getComponent(PlayerHealth);\r\n                if (healthComp) {\r\n                    healthComp.init(soldier);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}"]}