{"version":3,"sources":["file:///G:/Cocos/KillGrass/gecao/assets/scripts/PlayerHealthBar.ts"],"names":["_decorator","Component","ProgressBar","PlayerCombat","ccclass","property","PlayerHealthBar","_progressBar","_playerCombat","_maxHealth","start","getComponentInChildren","playerNode","node","parent","combatNodes","children","filter","child","getComponent","length","health","yOffset","setPosition","update","currentHealth","progress"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,W,OAAAA,W;;AAC7BC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;iCAGjBM,e,WADZF,OAAO,CAAC,iBAAD,C,gBAAR,MACaE,eADb,SACqCL,SADrC,CAC+C;AAAA;AAAA;AAAA,eACnCM,YADmC;AAAA,eAEnCC,aAFmC;AAAA,eAGnCC,UAHmC;AAAA;;AAK3CC,QAAAA,KAAK,GAAG;AACJ,eAAKH,YAAL,GAAoB,KAAKI,sBAAL,CAA4BT,WAA5B,CAApB,CADI,CAGJ;;AACA,gBAAMU,UAAU,GAAG,KAAKC,IAAL,CAAUC,MAA7B;;AACA,cAAIF,UAAJ,EAAgB;AACZ;AACA,kBAAMG,WAAW,GAAGH,UAAU,CAACI,QAAX,CAAoBC,MAApB,CAA2BC,KAAK,IAAIA,KAAK,CAACC,YAAN;AAAA;AAAA,6CAApC,CAApB;;AACA,gBAAIJ,WAAW,CAACK,MAAZ,GAAqB,CAAzB,EAA4B;AACxB,mBAAKZ,aAAL,GAAqBO,WAAW,CAAC,CAAD,CAAX,CAAeI,YAAf;AAAA;AAAA,+CAArB;AACA,mBAAKV,UAAL,GAAkB,KAAKD,aAAL,CAAmBa,MAArC,CAFwB,CAIxB;;AACA,oBAAMC,OAAO,GAAG,CAAC,EAAjB;AACA,mBAAKT,IAAL,CAAUU,WAAV,CAAsB,CAAtB,EAAyBD,OAAzB,EAAkC,CAAlC;AACH;AACJ;AACJ;;AAEDE,QAAAA,MAAM,GAAG;AACL,cAAI,KAAKhB,aAAL,IAAsB,KAAKD,YAA/B,EAA6C;AACzC,kBAAMkB,aAAa,GAAG,KAAKjB,aAAL,CAAmBa,MAAzC;AACA,iBAAKd,YAAL,CAAkBmB,QAAlB,GAA6BD,aAAa,GAAG,KAAKhB,UAAlD;AACH;AACJ;;AA7B0C,O","sourcesContent":["import { _decorator, Component, Node, ProgressBar, Vec3 } from 'cc';\r\nimport { PlayerCombat } from './PlayerCombat';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PlayerHealthBar')\r\nexport class PlayerHealthBar extends Component {\r\n    private _progressBar: ProgressBar;\r\n    private _playerCombat: PlayerCombat;\r\n    private _maxHealth: number;\r\n\r\n    start() {\r\n        this._progressBar = this.getComponentInChildren(ProgressBar);\r\n        \r\n        // 获取父节点（Player）上的 PlayerCombat 组件\r\n        const playerNode = this.node.parent;\r\n        if (playerNode) {\r\n            // 获取带有 PlayerCombat 组件的子节点\r\n            const combatNodes = playerNode.children.filter(child => child.getComponent(PlayerCombat));\r\n            if (combatNodes.length > 0) {\r\n                this._playerCombat = combatNodes[0].getComponent(PlayerCombat);\r\n                this._maxHealth = this._playerCombat.health;\r\n                \r\n                // 设置血条位置，与 PlayerCombat 节点保持相同的 Y 轴偏移\r\n                const yOffset = -70;\r\n                this.node.setPosition(0, yOffset, 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    update() {\r\n        if (this._playerCombat && this._progressBar) {\r\n            const currentHealth = this._playerCombat.health;\r\n            this._progressBar.progress = currentHealth / this._maxHealth;\r\n        }\r\n    }\r\n}"]}