{"version":3,"sources":["file:///G:/Cocos/KillGrass/gecao/assets/scripts/CameraController.ts"],"names":["_decorator","Component","Node","Vec3","Camera","ccclass","property","CameraController","type","tooltip","_camera","_currentPos","_targetPos","_healthBarOffset","start","getComponent","target","pos","worldPosition","set","x","y","node","setWorldPosition","lateUpdate","deltaTime","targetWorldPos","lerp","followSpeed","healthBar","healthBarPos","add"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;;;;;;;;;OACtC;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;kCAGjBO,gB,WADZF,OAAO,CAAC,kBAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEN,IAAR;AAAcO,QAAAA,OAAO,EAAE;AAAvB,OAAD,C,UAGRH,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEN,IAAR;AAAcO,QAAAA,OAAO,EAAE;AAAvB,OAAD,C,UAGRH,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE;AAAX,OAAD,C,2BARb,MACaF,gBADb,SACsCN,SADtC,CACgD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAUpCS,OAVoC,GAUX,IAVW;AAAA,eAWpCC,WAXoC,GAWhB,IAAIR,IAAJ,EAXgB;AAAA,eAYpCS,UAZoC,GAYjB,IAAIT,IAAJ,EAZiB;AAAA,eAapCU,gBAboC,GAaX,IAAIV,IAAJ,CAAS,CAAT,EAAY,CAAC,EAAb,EAAiB,CAAjB,CAbW;AAAA;;AAaU;AAEtDW,QAAAA,KAAK,GAAG;AACJ,eAAKJ,OAAL,GAAe,KAAKK,YAAL,CAAkBX,MAAlB,CAAf;;AACA,cAAI,KAAKY,MAAT,EAAiB;AACb,gBAAMC,GAAG,GAAG,KAAKD,MAAL,CAAYE,aAAxB;;AACA,iBAAKP,WAAL,CAAiBQ,GAAjB,CAAqBF,GAAG,CAACG,CAAzB,EAA4BH,GAAG,CAACI,CAAhC,EAAmC,IAAnC;;AACA,iBAAKC,IAAL,CAAUC,gBAAV,CAA2B,KAAKZ,WAAhC;AACH;AACJ;;AAEDa,QAAAA,UAAU,CAACC,SAAD,EAAoB;AAC1B,cAAI,CAAC,KAAKT,MAAV,EAAkB,OADQ,CAG1B;;AACA,cAAMU,cAAc,GAAG,KAAKV,MAAL,CAAYE,aAAnC;;AACA,eAAKN,UAAL,CAAgBO,GAAhB,CAAoBO,cAAc,CAACN,CAAnC,EAAsCM,cAAc,CAACL,CAArD,EAAwD,IAAxD,EAL0B,CAO1B;;;AACAlB,UAAAA,IAAI,CAACwB,IAAL,CAAU,KAAKhB,WAAf,EAA4B,KAAKA,WAAjC,EAA8C,KAAKC,UAAnD,EAA+D,KAAKgB,WAAL,GAAmBH,SAAlF;AACA,eAAKH,IAAL,CAAUC,gBAAV,CAA2B,KAAKZ,WAAhC,EAT0B,CAW1B;;AACA,cAAI,KAAKkB,SAAT,EAAoB;AAChB,gBAAMC,YAAY,GAAG,IAAI3B,IAAJ,EAArB;AACAA,YAAAA,IAAI,CAAC4B,GAAL,CAASD,YAAT,EAAuBJ,cAAvB,EAAuC,KAAKb,gBAA5C;AACA,iBAAKgB,SAAL,CAAeN,gBAAf,CAAgCO,YAAhC;AACH;AACJ;;AAzC2C,O;;;;;iBAEf,I;;;;;;;iBAGG,I;;;;;;;iBAGH,G","sourcesContent":["import { _decorator, Component, Node, Vec3, Camera } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('CameraController')\nexport class CameraController extends Component {\n    @property({ type: Node, tooltip: '要跟随的目标' })\n    public target: Node | null = null;\n\n    @property({ type: Node, tooltip: '血条节点' })\n    public healthBar: Node | null = null;\n\n    @property({ tooltip: '相机跟随速度' })\n    public followSpeed: number = 5.0;\n\n    private _camera: Camera | null = null;\n    private _currentPos: Vec3 = new Vec3();\n    private _targetPos: Vec3 = new Vec3();\n    private _healthBarOffset: Vec3 = new Vec3(0, -70, 0); // 血条偏移量\n\n    start() {\n        this._camera = this.getComponent(Camera);\n        if (this.target) {\n            const pos = this.target.worldPosition;\n            this._currentPos.set(pos.x, pos.y, 1000);\n            this.node.setWorldPosition(this._currentPos);\n        }\n    }\n\n    lateUpdate(deltaTime: number) {\n        if (!this.target) return;\n\n        // 获取目标的世界坐标\n        const targetWorldPos = this.target.worldPosition;\n        this._targetPos.set(targetWorldPos.x, targetWorldPos.y, 1000);\n        \n        // 使用线性插值实现平滑跟随\n        Vec3.lerp(this._currentPos, this._currentPos, this._targetPos, this.followSpeed * deltaTime);\n        this.node.setWorldPosition(this._currentPos);\n\n        // 更新血条位置\n        if (this.healthBar) {\n            const healthBarPos = new Vec3();\n            Vec3.add(healthBarPos, targetWorldPos, this._healthBarOffset);\n            this.healthBar.setWorldPosition(healthBarPos);\n        }\n    }\n}"]}